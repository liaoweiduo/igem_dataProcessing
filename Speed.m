clear all;
array=[
-16,-5.241423991820443,4136.630616366914,12411.531205233656,37252.9704199941;
-16,-5.2415543791888295,4130.983172478206,12394.589975503135,37202.15571273181;
-16,-5.251165784539271,3682.784819517925,11050.759392216194,33177.454726167896;
-16,-5.258998832682899,3317.5146985109636,9955.572060869952,29897.427053205643;
-16,-5.027023590378485,3383.027318169452,10151.671188545686,30481.77586367943;
-16,-5.034715390559313,3732.8062178396135,11200.21896539489,33620.473139673864;
-16,-5.208517409130563,5053.204741057857,15158.679452349417,45469.97312173384;
-16,-5.209568373195725,5041.950312017676,15124.962738296943,45369.2874540415;
-16,-5.173617369043048,5317.5597359494495,15951.446403356586,47844.140725862286;
-16,-5.191132299220566,5269.854525185647,15807.42797640499,47404.29842374951;
-16,-5.220138768708485,4908.149833815021,14724.469131967862,44176.62788791989;
-16,-5.226635308987751,4811.387672580463,14434.739262633104,43312.82829085302;
-16,-5.238548039346526,4270.973790549474,12814.354369032642,38459.54834648884;
-16,-5.238565940596937,4270.137576865219,12811.847012451988,38452.038050723735;
-16,-5.035690975757552,3773.936404620336,11323.593464519576,33990.46079152053;
-16,-5.035780019121292,3777.690428698032,11334.854070866822,34024.230212115435;
-16,-5.171943516143482,5322.3083955422635,15965.725669017216,47887.29862159125;
-16,-5.171976840478743,5322.213855613005,15965.441386525728,47886.43940131829;
-16,-5.084716930690246,5176.128328101022,15527.11506253784,46572.12921835569;
-16,-5.08482219686044,5177.106068413385,15530.046091073127,46580.900218784234;
-16,-5.085988449654508,5187.938536140807,15562.519204432312,46678.07487547447;
-16,-5.110095955405816,5331.105745768618,15992.172882282479,47967.5663271113;
-16,-5.111557149042545,5334.174558431243,16001.400576929358,47995.43637802529;
-16,-5.110065500661701,5331.041784439145,15991.98055525664,47966.985449203035;
-16,-5.095802898423844,5302.675808784929,15906.265036838067,47704.66729216079;
-16,-5.106296597281041,5323.546044996929,15969.33013675792,47897.66759059842;
-16,-5.061163296779576,4905.1389754103275,14715.651489466176,44152.51745699751;
-16,-5.145113745446229,5413.994003417823,16241.737787890013,48723.94763455203;
-16,-5.741015545084907,348.9215907823551,1046.8385817632172,3141.423265632695;
-16,-5.7430378938932325,340.2072288342855,1020.696261284666,3062.997251846915;
-16,-5.526903737729564,407.0165996652005,1221.123637054409,3664.318138464812;
-16,-5.527440524490866,409.3313418804991,1228.0680385222583,3685.154505418452;
-16,-5.527783768075389,410.8114834833454,1232.5085751192257,3698.4781374748636;
-16,-5.5414481079941105,474.8953587472696,1424.7585698504276,4275.25690622484;
-16,-5.543972456981343,486.7342108773299,1460.2748250508664,4381.810990686937;
-16,-5.551689514460607,496.7060633362714,1490.1888535834285,4471.545583014522;
-16,-5.569553668833853,519.789828032304,1559.436608686601,4679.271503363892;
-16,-5.510649549964252,332.12463905525675,996.4502977013318,2990.2695122613027;
-16,-5.73980377243963,353.9244352333825,1061.8472452630053,3186.453860101627;
-16,-5.7408583957562485,349.5703870875059,1048.7849875555419,3147.2630800662946;
-16,-5.6210071885066775,547.6429770760641,1643.0006965309697,4930.022927965885;
-16,-5.624498004336809,548.5215262365995,1645.636520528834,4937.932548874201;
-16,-5.627806342554608,548.0273804292816,1644.1523549041367,4933.464189445007;
-16,-5.593852125002011,540.0040863064244,1620.0826816200154,4861.2518983289;
-16,-5.629991058034117,547.6321552686799,1642.9655401130528,4929.893240898347;
-16,-5.665978005886734,541.1221685787968,1623.4168221896966,4871.074137605569;
-16,-5.70801151285112,492.9653622810432,1478.9642329702594,4437.847063520032;
-16,-5.66960898245917,539.2516295323418,1617.803899492089,4854.22242655863;
-16,-5.66652022811117,541.0479181576643,1623.1937973930674,4870.4025484367;
-16,-5.669159551626252,539.6521754600052,1619.0056622850682,4857.829092632418;
-16,-5.669176930630264,539.6366867815096,1618.9591914155196,4857.689626749254;
-16,-5.5698922560279165,520.1676968210654,1560.5702495729388,4682.672981512554;
-16,-5.570212026282051,520.5245656014976,1561.6408885159042,4685.885422960404;
-16,-5.593598824431225,539.9510581560139,1619.923529516309,4860.773803777462;
-16,-5.583305969023055,537.4195429630674,1612.3231872129409,4837.9193682783425;
-16,-5.668151226536357,540.7958559965194,1622.4364816279403,4868.120274056418;
-16,-6.193266286107674,59.6734686177666,179.04452592473135,537.3793287741439;
-16,-6.217793312316401,46.28577969242471,138.87596593250964,416.81777836550623;
-16,-6.162238883135544,64.71625763792724,194.17420441288385,582.7825755749026;
-16,-5.995843093715562,40.40877150877842,121.2428014001118,363.8962001021033;
-16,-6.016962588070493,51.95075428696311,155.87305270432904,467.8312187060467;
-16,-6.218590239795404,45.86501063270516,137.6135019104941,413.02877254714167;
-16,-6.218741646440694,45.785069571573196,137.37364892881206,412.3089070082976;
-16,-6.2296089723251065,40.009245460869494,120.04399004390854,360.2974776604719;
-16,-6.161587104988015,64.80324460891062,194.435201247887,583.5659309731385;
-16,-6.161856123001651,64.76734119253096,194.3274761721109,583.242605138061;
-16,-6.017130134163343,52.037648247908045,156.13376878458854,468.61371644216354;
-16,-6.017600494418245,52.28158987163743,156.8656896598549,470.8104602230778;
-16,-6.071024914885937,65.21458674641367,195.66981198419316,587.2752229532512;
-16,-6.073128244809594,65.48661127212239,196.4859923187118,589.7248552952341;
-16,-6.0544337038297975,63.06883925151924,189.2317273701304,567.9523603832612;
-16,-6.104160155211936,66.58546461135622,199.78279360474832,599.6179552099065;
-16,-6.053925809778365,63.00978739943363,189.05454567788397,567.4205517377311;
-16,-6.053730036226263,62.987025190123234,188.98624897552799,567.2155600349828;
-16,-6.104755828032454,66.60164877313828,199.8313477788633,599.7636407126159;
-16,-6.105109338013321,66.61125348740732,199.86016292386583,599.8500997853854;
-16,-6.141197684212344,67.91481376136446,203.77110104819081,611.5858487536259;
-16,-6.140965913852666,67.92163114872403,203.79155676262528,611.6472511731;
-16,-6.140922841188044,67.92289810556218,203.7953582933166,611.6586623209681;
-16,-6.032579663774209,60.446364491743985,181.36309230743433,544.3342981315212;
-16,-5.2816663877430505,545.0253549909974,1635.2253607568398,4907.431641978421;
-16,-5.285,2.8932257943537283E-10,8.680470433128252E-10,2.6050735280866003E-9;
-16,-5.2816373726898895,549.7677119111262,1649.4537296286992,4950.132015581676;
-16,-5.281563814503311,561.7902890085968,1685.5247517477023,5058.383785308766;
-16,-5.273179487575366,1930.752689896896,5792.7857509025625,17384.565523562054;
-16,-5.010960848045879,1770.6855162506713,5312.287783063204,15940.268357807472;
-16,-5.012287297835567,1984.63222475318,5954.155650459113,17866.281633373048;
-16,-5.010949394841987,1768.8377859834866,5306.744352429466,15923.634525664182;
-16,-5.010855668311175,1753.7167540034923,5261.37929365621,15787.51037620119;
-16,-5.000000000000002,1.3237733947106583E-12,3.971493860547242E-12,1.1917034287176114E-11;
-16,-5.758318713399745,190.4650983104236,571.4282196431692,1714.7134005285664;
-16,-5.769999999999998,1.110989018593024E-13,3.333159161709552E-13,1.0001978848087726E-12;
-16,-5.758218166010069,192.10204918625027,576.3393551324103,1729.4504908195574;
-16,-5.758214137494949,192.16763380835306,576.5361203315551,1730.0409340093158;
-16,-5.757740663987456,199.8751844289465,599.6601040078108,1799.4302299335197;
-16,-5.493499455277323,140.6918785728746,422.0999440793481,1266.6160964405112;
-16,-5.496659944462673,192.92892868407435,578.820116792876,1736.894012239209;
-16,-5.493471677068303,140.23252423730477,420.7218017241465,1262.4806369410298;
-16,-5.493397950937142,139.01333422960596,417.06402109848324,1251.5045548354174;
-16,-5.484999999999998,1.286783531937561E-13,3.860572962822452E-13,1.1584611838135213E-12;
-16,-5.973798431539516,7.626464789248294,22.882461107251647,68.67864756176112;
-16,-5.9817485265382135,23.567519590636806,70.71203557204423,212.2327192294446;
-16,-5.973729645023183,7.488402749304161,22.468219470455594,67.43535667676274;
-16,-5.97369697434603,7.422828476733598,22.271470284271775,66.84484030153808;
-16,-5.969999999999997,0,0,0;
-16,-6.253142621573123,3.756689217325927,11.271583427114436,33.83019704134735;
-16,-6.254999999999996,1.5554710340893017E-14,4.6670407136507477E-14,1.4007517920797262E-13;
-16,-6.2531263665207755,3.7895609510238994,11.370211891544617,34.12621759685967;
-16,-6.253041138202519,3.961912090731328,11.887334852217073,35.67829515353802;
-16,-6.243457251840924,23.320931431386082,69.97220408083886,210.01250413253297;
-16,-5.2691977269109165,2320.4562704401337,6962.604226085694,20900.954483475314;
-16,-5.269144467053458,2325.667811194533,6978.24829494268,20947.979244303926;
-16,-5.269009495512751,2338.8747875642393,7017.89316098905,21067.148368805596;
-16,-5.0254872696721336,3237.4187319794923,9714.606655954118,29168.228824054007;
-16,-5.02546688464264,3235.4862381079274,9708.805995628773,29150.795517859446;
-16,-5.025294310068991,3219.125789893564,9659.697730684597,29003.205436809854;
-16,-5.7437427345560215,333.4891374982922,1000.5400897347909,3002.5069526572665;
-16,-5.7435569609847,335.25996688416154,1005.8530783744039,3018.4516635627956;
-16,-5.743550239696667,335.32403347531357,1006.0452962507165,3019.0285250025154;
-16,-5.506905758686916,294.9133931418679,884.8051061463747,2655.2047889427004;
-16,-5.506855199583473,294.41058376453816,883.2965228571227,2650.6772904505406;
-16,-5.5067195042567745,293.06106533807775,879.2475510994146,2638.5256815565654;
-16,-5.986352233357929,29.072298404921664,87.2286639909101,261.805877488643;
-16,-5.986226740210018,28.92227718528155,86.77853787462219,260.45486493364564;
-16,-5.986167067736476,28.850940744669092,86.56449885361714,259.8124462987588;
-16,-6.241246435816772,25.98732439254763,77.97247665822137,234.02444664209852;
-16,-6.241216980621516,26.02284577660268,78.0790553801148,234.34433100775226;
-16,-6.241061927275516,26.209830125905974,78.64008512282804,236.0282003582288;
];

ex_fast=[720,660,650]*90;    %*10转换单位统一为 um/s
ex_mid=[220,160,180]*30;
ex_slow=[90,95,80]*10;

array=sortrows(array,2);
x=array(:,2);
y1=array(:,3);
y2=array(:,4);
y3=array(:,5);
slow= [9*max(y1(1              : size(y1,1)/3  ));3*max(y2(1              : size(y2,1)/3  ));max(y3(1            : size(y3,1)/3  ))];
mid = [9*max(y1(size(y1,1)/3   : size(y1,1)*2/3));3*max(y2(size(y2,1)/3   : size(y2,1)*2/3));max(y3(size(y2)/3   : size(y3,1)*2/3))];
fast= [9*max(y1(size(y1,1)*2/3 : size(y1,1)    ));3*max(y2(size(y2,1)*2/3 : size(y2,1)    ));max(y3(size(y2)*2/3 : size(y2,1)    ))];
slow_mean=mean(slow);slow_std=std(slow);
mid_mean=mean(mid);  mid_std=std(mid);
fast_mean=mean(fast);fast_std=std(fast);

ex_fast_mean=mean(ex_fast);ex_fast_std=std(ex_fast);
ex_mid_mean=mean(ex_mid);ex_mid_std=std(ex_mid);
ex_slow_mean=mean(ex_slow);ex_slow_std=std(ex_slow);



sprintf('Simulation:');
sprintf('fast:%f; mid:%f; low:%f',fast_mean,mid_mean,slow_mean);
sprintf('Experiment:');
sprintf('fast:%f; mid:%f; low:%f',ex_fast_mean,ex_mid_mean,ex_slow_mean);

figure(1);
hold on;
plot(x,y1,'r');
plot(x,y2,'g');
plot(x,y3,'k');
h = legend({'pump speed: 5ul/min','pump speed: 15ul/min','pump speed: 45ul/min'});set(h,'fontsize',20);
t = title('Speed Simulation');set(t,'fontsize',20);
xlabel('x:mm','fontsize',15);
ylabel('speed:um/s','fontsize',15);
hold off;